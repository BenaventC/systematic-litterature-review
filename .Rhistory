t0 <-as.data.frame(prop.table(table(df$review)))
knitr::opts_chunk$set(echo = TRUE,message=FALSE, warning=FALSE)
library(tidyverse)
library(Rtsne)
library(ggrepel)
library(ggwordcloud)
library(quanteda)
library(quanteda.textstats)
library(quanteda.textmodels)
library(word2vec)
library(ape)
library(cowplot)
theme_set(theme_minimal()+theme(plot.title = element_text(size=12)))
df <- read_csv("NLP Marketing and consumer - dataforR.csv") %>%
filter(!is.na(text))
head(df,5)
t0 <-as.data.frame(prop.table(table(df$review)))
g01<-ggplot(t0,aes(x=reorder(Var1, Freq), y=Freq))+geom_bar(stat="identity")+coord_flip()+labs( title="Nombre d'articles par revue", y="Proportion", x= NULL)
t1<-as.data.frame(table(df$year))
g02<-ggplot(t1, aes(x=Var1, y=Freq, group=1))+ geom_smooth(color="Grey70", size=2)+
geom_line(stat="identity", size=1.1) +
labs( title=paste("Nombre de publications par an. Total =",nrow(df)), y=NULL, x=NULL)
plot_grid(g01, g02, labels = c('A', 'B'), label_size = 10, ncol=2,  rel_widths =  c(1,1))
ggsave(filename="quant.jpeg", plot=last_plot(), width = 27, height = 18, units = "cm")
g01<-ggplot(t0,aes(x=reorder(Var1, Freq), y=Freq))+
geom_bar(stat="identity", color="dodgeblue")+
coord_flip()+
labs( title="Marketing et NLP : Nombre d'articles par revue", y="Proportion", x= NULL)
g01
g01<-ggplot(t0,aes(x=reorder(Var1, Freq), y=Freq))+
geom_bar(stat="identity", color="Skyvlue")+
coord_flip()+
labs( title="Marketing et NLP : Nombre d'articles par revue", y="Proportion", x= NULL)
g01
g01<-ggplot(t0,aes(x=reorder(Var1, Freq), y=Freq))+
geom_bar(stat="identity", color="Skyblue")+
coord_flip()+
labs( title="Marketing et NLP : Nombre d'articles par revue", y="Proportion", x= NULL)
g01
g01<-ggplot(t0,aes(x=reorder(Var1, Freq), y=Freq))+
geom_bar(stat="identity", fill="Skyblue")+
coord_flip()+
labs( title="Marketing et NLP : Nombre d'articles par revue", y="Proportion", x= NULL)
g01
g02<-ggplot(t1, aes(x=Var1, y=Freq, group=1))+
geom_smooth(color="Gold1", size=2)+
geom_line(stat="identity", size=1.1) +
labs( title=paste("Nombre de publications par an. Total =",nrow(df)), y=NULL, x=NULL)
plot_grid(g01, g02, labels = c('A', 'B'), label_size = 10, ncol=2,  rel_widths =  c(1,1))
g02<-ggplot(t1, aes(x=Var1, y=Freq, group=1))+
geom_smooth(fill="Gold1", size=2)+
geom_line(stat="identity", size=1.1) +
labs( title=paste("Nombre de publications par an. Total =",nrow(df)), y=NULL, x=NULL)
g02<-ggplot(t1, aes(x=Var1, y=Freq, group=1))+
geom_smooth(fill="Gold1", size=2)+
geom_line(stat="identity", size=1.1) +
labs( title=paste("Nombre de publications par an. Total =",nrow(df)), y=NULL, x=NULL)
plot_grid(g01, g02, labels = c('A', 'B'), label_size = 10, ncol=2,  rel_widths =  c(1,1))
g02<-ggplot(t1, aes(x=Var1, y=Freq, group=1))+
geom_smooth(fill="Gold1", alpha=.5)+
geom_line(stat="identity", size=1.1) +
labs( title=paste("Nombre de publications par an. Total =",nrow(df)), y=NULL, x=NULL)
plot_grid(g01, g02, labels = c('A', 'B'), label_size = 10, ncol=2,  rel_widths =  c(1,1))
g02<-ggplot(t1, aes(x=Var1, y=Freq, group=1))+
geom_smooth(fill="Gold1", alpha=.5)+
geom_line(stat="identity", size=1.1) +
labs( subtitle=paste("Total =",nrow(df)), y=NULL, x=NULL)
plot_grid(g01, g02, labels = c('A', 'B'), label_size = 10, ncol=2,  rel_widths =  c(1,1))
g02<-ggplot(t1, aes(x=Var1, y=Freq, group=1))+
geom_smooth(fill="Gold1", alpha=.5)+
geom_line(stat="identity", size=1.1) +
labs( caption=paste("Total =",nrow(df)), y=NULL, x=NULL)
plot_grid(g01, g02, labels = c('A', 'B'), label_size = 10, ncol=2,  rel_widths =  c(1,1))
plot_grid(g01, g02, labels = c('', ''), label_size = 10, ncol=2,  rel_widths =  c(1,1))
g02<-ggplot(t1, aes(x=Var1, y=Freq, group=1))+
geom_smooth(fill="Gold1", alpha=.5)+
geom_line(stat="identity", size=1) +
labs( caption=paste("Total =",nrow(df)), y=NULL, x=NULL)
plot_grid(g01, g02, labels = c('', ''), label_size = 10, ncol=2,  rel_widths =  c(1,1))
g02<-ggplot(t1, aes(x=Var1, y=Freq, group=1))+
geom_smooth(fill="Gold1", alpha=.2)+
geom_line(stat="identity", size=1) +
labs( caption=paste("Total =",nrow(df)), y=NULL, x=NULL)
plot_grid(g01, g02, labels = c('', ''), label_size = 10, ncol=2,  rel_widths =  c(1,1))
t0 <-as.data.frame(prop.table(table(df$review)))
g01<-ggplot(t0,aes(x=reorder(Var1, Freq), y=Freq))+
geom_bar(stat="identity", fill="Skyblue")+
coord_flip()+
labs( title="Marketing et NLP : Nombre d'articles par revue et par an", y="Proportion", x= NULL)
g01
t1<-as.data.frame(table(df$year))
g02<-ggplot(t1, aes(x=Var1, y=Freq, group=1))+
geom_smooth(fill="Gold1", alpha=.2)+
geom_line(stat="identity", size=1) +
labs( caption=paste("Total =",nrow(df)), y=NULL, x=NULL)
plot_grid(g01, g02, labels = c('', ''), label_size = 10, ncol=2,  rel_widths =  c(1,1))
ggsave(filename="quant.jpeg", plot=last_plot(), width = 27, height = 18, units = "cm")
